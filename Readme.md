# Design Document: Ringworld Atmospheric Ray-Tracer

1. The core idea is that we can model the structure of the ring system (width, diameter, distance to sun, rim walls, atmosphere, and shadow squares)

Key Mathematical Constants
 * Radius (R): 92,955,807 miles.
 * Ring Width: 1,000,000 miles.
 * Rim Wall Height (H): 1,000 miles 

2. Generate or model real earth topography, and place it in an arbitrary place on the ring

3. Use the above 2 features to place a camera viewpoint somewhere visually interesting, and render a scene via ray tracing.

Some key visual features we're interested in:

* appearance of the "infinite horizon" generated by atmospheric scattering, instead of curvature.
* Appearance of the "arch" in the sky,.and how it varies as we near one edge of the ring.
* How the arch transitions into the horizon 
* Using relatable terrain features to put the unfamiliar arch and horizon in context 
* Explore unfamiliar lighting situations, such as from the archlight, and from shadow square transit.


1. Project Motivation
The goal is to render a physically accurate view from the surface of a Ringworld megastructure (R \approx 93,000,000 miles). The defining visual characteristic is the Arch—the distant side of the ring visible in the sky—and the Optical Horizon, where the ground vanishes into haze not due to curvature, but due to the accumulation of air mass along the longitudinal axis.

2. Core Scientific Principles
 * The Scale Gap: Managing the ratio between planetary-scale terrain (miles) and astronomical-scale structures (millions of miles).
 * Cylindrical Geometry: Upward curvature (y = R - \sqrt{x^2 + z^2}) creates a "rising" horizon.
 * Volumetric Optical Depth:
   * Along the Ring: Rays stay within the dense atmosphere (h < 50 miles), reaching 100% opacity (extinction) quickly.
   * Across the Ring (The Arch): Rays exit the atmosphere, travel through vacuum, and re-enter. Total air mass is low, keeping the Arch visible.
 * Beer-Lambert Law: Light transmission follows T = e^{-\tau}, where \tau is the integrated optical depth.


3. Modular Architecture
Module A: RingGeometry (The Megastructure)
 * Constants: R = 92.9M miles, W = 1M miles.
 * Analytical Intersections: Mathematically solve for the ray-cylinder intersection to identify when a pixel is looking at the "Arch" vs. "Deep Space."
 * Shadow Squares: A periodic mask applied to the central light source to determine the day/night terminator.
Module B: AtmosphereSystem (The Volumetric Engine)
 * Density Profile: Exponential decay model \rho(h) = \rho_0 e^{-h/H}, where H is the scale height.
 * Integration: Instead of T(dist), calculate T(Ray) by integrating \rho(h) along the ray's path until it exits the ring's atmosphere or hits terrain.
 * Scattering: Implement Rayleigh-style coloring where high optical depth shifts toward the "horizon color" (white/blue).
Module C: SyntheticTerrain (The Local World)
 * Base: Gaussian peaks representing the Presidential Range (NH).
 * Detail: Fractal Brownian Motion (fBM) noise to add ruggedness without requiring external data files.
 * Coordinate Mapping: Transform local Cartesian (x, y, z) coordinates into the Ring’s cylindrical frame.
Module D: Renderer (The Engine)
 * Ray-Marching: Use a "step-and-sample" approach for the first 100 miles of terrain.
 * Analytical Leap: If no terrain is hit within the local limit, "leap" the ray to the Arch intersection point calculated by Module A.
 * Composition: Final pixel color = (Terrain/Arch Color \times Transmittance) + (In-scattered Sky Color).
